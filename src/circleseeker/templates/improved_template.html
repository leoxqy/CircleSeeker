<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eccDNA Analysis Report - {sample_name}</title>
    <link rel="stylesheet" href="{css_path}">
</head>
<body>
    <div class="container">
        <h1>üß¨ eccDNA Analysis Report - {sample_name}</h1>

        <h2>üìä 1. Read Classification Statistics</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Reads</h3>
                <div class="stat-value color-primary">{total_reads:,}</div>
                <div class="stat-percentage">100% of dataset</div>
            </div>
            <div class="stat-card">
                <h3>CtcReads</h3>
                <div class="stat-value color-danger">{total_ctcr:,}</div>
                <div class="stat-percentage">{ctcr_percentage:.2f}% of total</div>
                <div class="stat-percentage">Ctc = Concatemeric tandem copies</div>
            </div>
            <div class="stat-card">
                <h3>Other Reads</h3>
                <div class="stat-value color-secondary">{other_reads:,}</div>
                <div class="stat-percentage">{other_percentage:.2f}% of total</div>
            </div>
        </div>

        <h2>üîç 2. CtcReads Subtype Distribution</h2>
        <table>
            <thead>
                <tr>
                    <th>CtcReads Subtype</th>
                    <th>Count</th>
                    <th>Percentage of CtcReads</th>
                    <th>Percentage of Total Reads</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>CtcR-perfect</strong></td>
                    <td>{ctcr_perfect:,}</td>
                    <td>{ctcr_perfect_pct:.2f}%</td>
                    <td>{ctcr_perfect_total_pct:.2f}%</td>
                </tr>
                <tr>
                    <td><strong>CtcR-hybrid</strong></td>
                    <td>{ctcr_hybrid:,}</td>
                    <td>{ctcr_hybrid_pct:.2f}%</td>
                    <td>{ctcr_hybrid_total_pct:.2f}%</td>
                </tr>
                <tr>
                    <td><strong>CtcR-inversion</strong></td>
                    <td>{ctcr_inversion:,}</td>
                    <td>{ctcr_inversion_pct:.2f}%</td>
                    <td>{ctcr_inversion_total_pct:.2f}%</td>
                </tr>
            </tbody>
        </table>

        <h2>üìà 3. eccDNA Summary Statistics</h2>

        <div class="note-box">
            <strong>üìå Important Note:</strong> UeccDNA<sup>*</sup> and CeccDNA<sup>*</sup> represent combined counts integrating both confirmed and inferred eccDNA sequences for comprehensive analysis.
        </div>

        <table>
            <thead>
                <tr>
                    <th>eccDNA Type</th>
                    <th>Count</th>
                    <th>Min Length (bp)</th>
                    <th>Max Length (bp)</th>
                    <th>Mean Length (bp)</th>
                    <th>Median Length (bp)</th>
                    <th>Mode Length (bp)</th>
                    <th>Std Dev</th>
                </tr>
            </thead>
            <tbody>
                {summary_stats_rows}
            </tbody>
        </table>

        <div class="inference-summary">
            <h4>üîÆ Inference Analysis Details</h4>
            <div class="inference-details">
                <div class="inference-item">
                    <strong>Inferred UeccDNA:</strong>
                    <span>
                        <span class="inference-count">{inferred_uecc_count:,}</span> sequences,
                        <span class="inference-note">{inferred_uecc_overlaps:,} ({inferred_uecc_overlap_pct:.2f}%) overlap with confirmed UeccDNA</span>
                    </span>
                </div>
                <div class="inference-item">
                    <strong>Inferred CeccDNA:</strong>
                    <span>
                        <span class="inference-count">{inferred_cecc_count:,}</span> sequences,
                        <span class="inference-note">{inferred_cecc_overlaps:,} ({inferred_cecc_overlap_pct:.2f}%) overlap with confirmed CeccDNA</span>
                    </span>
                </div>
            </div>
        </div>

        <div class="footer">
            <p><strong>Report generated by CircleSeeker v{version}</strong></p>
            <p>Analysis Date: {generation_date}</p>
            <p>For questions regarding this analysis, please refer to the CircleSeeker documentation</p>
        </div>
    </div>
</body>
</html>

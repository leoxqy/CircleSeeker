<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eccDNA Analysis Report - {sample_name}</title>
    <link rel="stylesheet" href="{css_path}">
</head>
<body>
    <div class="container">
        <h1>eccDNA Analysis Report<br><span style="font-weight: 400; color: #6c757d;">{sample_name}</span></h1>

        <h2>Read Classification Statistics</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Reads</h3>
                <div class="value number">{total_reads:,}</div>
            </div>
            <div class="stat-card">
                <h3>CtcReads</h3>
                <div class="value number">{total_ctcr:,}</div>
                <div class="subtitle">{ctcr_percentage:.2f}% of total</div>
                <div class="subtitle">Ctc = Concatemeric tandem copies</div>
            </div>
            <div class="stat-card">
                <h3>Other Reads</h3>
                <div class="value number">{other_reads:,}</div>
                <div class="subtitle">{other_percentage:.2f}% of total</div>
            </div>
        </div>

        <h2>CtcReads Subtype Distribution</h2>
        <table>
            <thead>
                <tr>
                    <th>CtcReads Subtype</th>
                    <th>Count</th>
                    <th>% of CtcReads</th>
                    <th>% of Total</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>CtcR-perfect</strong></td>
                    <td class="number">{ctcr_perfect:,}</td>
                    <td class="number">{ctcr_perfect_pct:.2f}%</td>
                    <td class="number">{ctcr_perfect_total_pct:.2f}%</td>
                </tr>
                <tr>
                    <td><strong>CtcR-hybrid</strong></td>
                    <td class="number">{ctcr_hybrid:,}</td>
                    <td class="number">{ctcr_hybrid_pct:.2f}%</td>
                    <td class="number">{ctcr_hybrid_total_pct:.2f}%</td>
                </tr>
                <tr>
                    <td><strong>CtcR-inversion</strong></td>
                    <td class="number">{ctcr_inversion:,}</td>
                    <td class="number">{ctcr_inversion_pct:.2f}%</td>
                    <td class="number">{ctcr_inversion_total_pct:.2f}%</td>
                </tr>
            </tbody>
        </table>

        <h2>eccDNA Summary</h2>
        <table>
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Count</th>
                    <th>Min Length</th>
                    <th>Max Length</th>
                    <th>Mean Length</th>
                    <th>Median Length</th>
                    <th>Std Dev</th>
                </tr>
            </thead>
            <tbody>
                {summary_stats_rows}
            </tbody>
        </table>

        <div class="inference-summary">
            <h4>Inference Analysis</h4>
            <p><strong>Inferred UeccDNA:</strong> {inferred_uecc_count:,} sequences, {inferred_uecc_overlaps:,} ({inferred_uecc_overlap_pct:.2f}%) overlap with confirmed</p>
            <p><strong>Inferred CeccDNA:</strong> {inferred_cecc_count:,} sequences, {inferred_cecc_overlaps:,} ({inferred_cecc_overlap_pct:.2f}%) overlap with confirmed</p>
        </div>

        <h2>Validation Analysis</h2>
        <div class="overlap-section">
            <div class="summary-box">
                <strong>Total Inferred Sequences:</strong> <span class="number">{total_inferred:,}</span>
            </div>

            <div class="overlap-grid">
                <div class="overlap-card">
                    <div class="label">UeccDNA Overlaps</div>
                    <div class="number">{uecc_overlaps:,}</div>
                    <div class="percent">{uecc_overlap_pct:.2f}%</div>
                </div>
                <div class="overlap-card">
                    <div class="label">MeccDNA Overlaps</div>
                    <div class="number">{mecc_overlaps:,}</div>
                    <div class="percent">{mecc_overlap_pct:.2f}%</div>
                </div>
                <div class="overlap-card">
                    <div class="label">CeccDNA Overlaps</div>
                    <div class="number">{cecc_overlaps:,}</div>
                    <div class="percent">{cecc_overlap_pct:.2f}%</div>
                </div>
            </div>

            <div class="summary-box">
                <p>Among <span class="number">{total_inferred:,}</span> inferred eccDNA sequences,
                <span class="number">{uecc_overlaps:,}</span> ({uecc_overlap_pct:.2f}%) overlap with UeccDNA,
                <span class="number">{mecc_overlaps:,}</span> ({mecc_overlap_pct:.2f}%) with MeccDNA,
                and <span class="number">{cecc_overlaps:,}</span> ({cecc_overlap_pct:.2f}%) with CeccDNA.</p>

                <p style="margin-top: 16px; color: #6c757d; font-size: 14px;">
                Overlaps determined by sequence content comparison. This validation assesses computational prediction accuracy.
                </p>
            </div>
        </div>

        <div class="footer">
            <p>CircleSeeker v{version} | Generated {generation_date}</p>
        </div>
    </div>
</body>
</html>
